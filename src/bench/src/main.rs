extern crate rand;
extern crate time;
extern crate rbsegs;
use self::rand::random;
use time::PreciseTime;
use rbsegs::{rb_intersection, brute_force};

fn rnd() -> f64 {
    random::<f64>()
}

struct Case {
    name: String,
    red: Vec<Vec<Vec<f64>>>,
    blue: Vec<Vec<Vec<f64>>>,
}

fn convert_f64vec(array: Vec<Vec<[f64; 2]>>) -> Vec<Vec<Vec<f64>>> {
    let mut res: Vec<Vec<Vec<f64>>> = Vec::new();
    for i in 0..array.len() {
        let mut ln: Vec<Vec<f64>> = Vec::new();
        let v = &array[i];

        for j in 0..v.len() {
            let o = &v[j];
            ln.push(vec![o[0], o[1]])
        }
        res.push(ln);
    }
    res
}


fn clipper_to_graph(loops: &Vec<Vec<Vec<f64>>>) -> Vec<Vec<Vec<f64>>> {
    let mut edges: Vec<Vec<Vec<f64>>> = Vec::new();
    for i in 0..(loops).len() {
        let lp = &loops[i];
        for j in 0..lp.len() {
            let a = &lp[j];
            let b = &lp[(j + 1) % lp.len()];
            if a[0] == b[0] && a[1] == b[1] {
                continue
            }
            edges.push(vec![vec![a[0], a[1]], vec![b[0], b[1]]]);
        }
    }
    edges
}

fn init() -> Vec<Case> {
    let mut cases: Vec<Case> = Vec::new();
//    let mut gb_poly: Vec<Vec<Vec<f64>>> = Vec::new();
//    let mut arrow_poly: Vec<Vec<Vec<f64>>> = Vec::new();
//    let mut phantom_poly: Vec<Vec<Vec<f64>>> = Vec::new();
//    let mut skull_poly: Vec<Vec<Vec<f64>>> = Vec::new();

    for i in 1..3 {
        for j in 1..(i + 1) {
            let nr = 10f64.powi(i);
            let nb = 10f64.powi(j);
            let mut red: Vec<Vec<Vec<f64>>> = Vec::new();
            for _ in 0..nr as i32 {
                red.push(vec![vec![rnd(), rnd()], vec![rnd(), rnd()]])
            }

            let mut blue: Vec<Vec<Vec<f64>>> = Vec::new();
            for _ in 0..nb as i32 {
                blue.push(vec![vec![rnd(), rnd()], vec![rnd(), rnd()]])
            }

            cases.push(Case {
                name: format!("Random, red: {}, blue: {}", nr, nb).to_string(),
                red: red,
                blue: blue,
            })
        }
    }
    let gb_poly = vec![
        vec![[189.0, 154.0], [192.0, 155.0], [193.0, 154.0], [194.0, 151.0], [194.0, 150.0], [196.0, 151.0], [199.0, 151.0], [200.0, 150.0], [203.0, 149.0], [204.0, 149.0], [205.0, 149.0], [206.0, 149.0], [209.0, 150.0], [211.0, 149.0], [212.0, 149.0], [212.0, 152.0], [212.0, 155.0], [213.0, 156.0], [213.0, 156.0], [213.0, 159.0], [214.0, 159.0], [216.0, 161.0], [216.0, 161.0], [216.0, 163.0], [217.0, 163.0], [218.0, 166.0], [218.0, 166.0], [217.0, 163.0], [217.0, 162.0], [218.0, 162.0], [218.0, 163.0], [220.0, 165.0], [218.0, 167.0], [218.0, 167.0], [215.0, 168.0], [214.0, 170.0], [214.0, 171.0], [215.0, 170.0], [217.0, 168.0], [220.0, 168.0], [221.0, 168.0], [222.0, 170.0], [223.0, 172.0], [223.0, 174.0], [224.0, 176.0], [223.0, 178.0], [223.0, 179.0], [223.0, 179.0], [223.0, 180.0], [222.0, 180.0], [222.0, 180.0], [221.0, 178.0], [222.0, 177.0], [222.0, 174.0], [221.0, 174.0], [220.0, 172.0], [218.0, 172.0], [218.0, 174.0], [220.0, 174.0], [218.0, 174.0], [220.0, 176.0], [220.0, 178.0], [217.0, 180.0], [221.0, 179.0], [221.0, 180.0], [222.0, 181.0], [221.0, 182.0], [218.0, 183.0], [218.0, 183.0], [217.0, 182.0], [214.0, 184.0], [214.0, 187.0], [214.0, 189.0], [211.0, 191.0], [210.0, 191.0], [210.0, 190.0], [209.0, 189.0], [207.0, 189.0], [206.0, 189.0], [207.0, 189.0], [209.0, 191.0], [209.0, 191.0], [210.0, 191.0], [207.0, 192.0], [205.0, 191.0], [204.0, 191.0], [204.0, 191.0], [204.0, 192.0], [204.0, 194.0], [204.0, 195.0], [206.0, 195.0], [206.0, 198.0], [206.0, 199.0], [206.0, 200.0], [206.0, 202.0], [206.0, 203.0], [210.0, 206.0], [209.0, 207.0], [207.0, 211.0], [209.0, 212.0], [210.0, 212.0], [210.0, 213.0], [207.0, 212.0], [207.0, 213.0], [206.0, 213.0], [207.0, 215.0], [209.0, 216.0], [209.0, 218.0], [210.0, 222.0], [209.0, 226.0], [211.0, 226.0], [209.0, 231.0], [207.0, 232.0], [206.0, 234.0], [205.0, 237.0], [205.0, 240.0], [202.0, 246.0], [201.0, 247.0], [200.0, 247.0], [200.0, 247.0], [200.0, 248.0], [201.0, 249.0], [201.0, 248.0], [201.0, 250.0], [202.0, 251.0], [201.0, 254.0], [200.0, 254.0], [201.0, 253.0], [199.0, 254.0], [199.0, 253.0], [199.0, 253.0], [196.0, 254.0], [194.0, 251.0], [192.0, 253.0], [193.0, 251.0], [192.0, 251.0], [192.0, 251.0], [191.0, 251.0], [192.0, 253.0], [191.0, 253.0], [190.0, 254.0], [189.0, 255.0], [189.0, 255.0], [190.0, 254.0], [190.0, 253.0], [190.0, 251.0], [189.0, 251.0], [189.0, 249.0], [189.0, 251.0], [189.0, 253.0], [189.0, 253.0], [188.0, 255.0], [185.0, 254.0], [187.0, 253.0], [185.0, 253.0], [185.0, 253.0], [185.0, 254.0], [184.0, 254.0], [183.0, 254.0], [179.0, 254.0], [177.0, 255.0], [177.0, 255.0], [176.0, 255.0], [174.0, 255.0], [176.0, 256.0], [177.0, 257.0], [176.0, 257.0], [176.0, 258.0], [172.0, 258.0], [172.0, 260.0], [171.0, 260.0], [170.0, 260.0], [169.0, 259.0], [169.0, 260.0], [168.0, 260.0], [169.0, 261.0], [167.0, 262.0], [166.0, 264.0], [166.0, 264.0], [162.0, 265.0], [161.0, 264.0], [161.0, 264.0], [162.0, 262.0], [163.0, 261.0], [160.0, 262.0], [158.0, 261.0], [158.0, 262.0], [159.0, 262.0], [160.0, 264.0], [160.0, 265.0], [160.0, 265.0], [158.0, 267.0], [157.0, 267.0], [156.0, 267.0], [155.0, 267.0], [155.0, 267.0], [154.0, 268.0], [154.0, 270.0], [154.0, 269.0], [151.0, 269.0], [150.0, 272.0], [149.0, 272.0], [149.0, 270.0], [147.0, 270.0], [147.0, 272.0], [146.0, 272.0], [146.0, 272.0], [144.0, 270.0], [143.0, 272.0], [141.0, 270.0], [141.0, 272.0], [140.0, 272.0], [140.0, 271.0], [140.0, 273.0], [139.0, 273.0], [139.0, 273.0], [139.0, 273.0], [138.0, 272.0], [138.0, 273.0], [137.0, 273.0], [137.0, 273.0], [136.0, 272.0], [137.0, 270.0], [136.0, 269.0], [136.0, 270.0], [135.0, 270.0], [134.0, 270.0], [134.0, 272.0], [133.0, 272.0], [133.0, 272.0], [132.0, 272.0], [132.0, 270.0], [129.0, 272.0], [130.0, 272.0], [128.0, 272.0], [128.0, 271.0], [127.0, 272.0], [127.0, 271.0], [127.0, 271.0], [129.0, 269.0], [132.0, 269.0], [134.0, 267.0], [134.0, 267.0], [128.0, 269.0], [127.0, 269.0], [128.0, 268.0], [129.0, 267.0], [136.0, 266.0], [136.0, 266.0], [136.0, 265.0], [136.0, 265.0], [135.0, 264.0], [135.0, 262.0], [135.0, 264.0], [134.0, 266.0], [126.0, 266.0], [126.0, 267.0], [124.0, 267.0], [123.0, 267.0], [122.0, 267.0], [122.0, 267.0], [122.0, 267.0], [122.0, 266.0], [123.0, 267.0], [123.0, 266.0], [123.0, 265.0], [123.0, 265.0], [125.0, 265.0], [126.0, 264.0], [125.0, 264.0], [125.0, 262.0], [127.0, 261.0], [127.0, 262.0], [127.0, 261.0], [129.0, 261.0], [128.0, 261.0], [130.0, 259.0], [133.0, 259.0], [134.0, 259.0], [132.0, 259.0], [129.0, 260.0], [128.0, 260.0], [127.0, 260.0], [127.0, 260.0], [122.0, 262.0], [122.0, 261.0], [121.0, 261.0], [121.0, 260.0], [122.0, 259.0], [121.0, 258.0], [119.0, 259.0], [118.0, 260.0], [118.0, 258.0], [117.0, 258.0], [117.0, 256.0], [119.0, 256.0], [121.0, 256.0], [119.0, 255.0], [119.0, 255.0], [121.0, 254.0], [121.0, 254.0], [126.0, 251.0], [127.0, 250.0], [127.0, 251.0], [127.0, 251.0], [128.0, 249.0], [129.0, 249.0], [132.0, 249.0], [128.0, 248.0], [127.0, 248.0], [127.0, 249.0], [126.0, 248.0], [123.0, 249.0], [122.0, 248.0], [121.0, 248.0], [119.0, 248.0], [121.0, 249.0], [121.0, 249.0], [118.0, 248.0], [119.0, 249.0], [117.0, 249.0], [116.0, 248.0], [116.0, 248.0], [116.0, 247.0], [117.0, 247.0], [116.0, 246.0], [117.0, 246.0], [117.0, 247.0], [118.0, 247.0], [118.0, 245.0], [119.0, 245.0], [121.0, 244.0], [123.0, 244.0], [123.0, 245.0], [125.0, 246.0], [126.0, 244.0], [125.0, 243.0], [126.0, 242.0], [126.0, 244.0], [127.0, 246.0], [129.0, 246.0], [129.0, 246.0], [129.0, 246.0], [132.0, 246.0], [132.0, 245.0], [128.0, 245.0], [128.0, 243.0], [129.0, 244.0], [129.0, 243.0], [130.0, 240.0], [128.0, 239.0], [128.0, 239.0], [133.0, 238.0], [134.0, 237.0], [135.0, 238.0], [135.0, 237.0], [134.0, 237.0], [134.0, 237.0], [135.0, 235.0], [136.0, 235.0], [138.0, 236.0], [138.0, 235.0], [141.0, 236.0], [147.0, 234.0], [147.0, 235.0], [148.0, 235.0], [149.0, 234.0], [151.0, 234.0], [151.0, 234.0], [154.0, 234.0], [150.0, 233.0], [149.0, 233.0], [149.0, 232.0], [148.0, 231.0], [147.0, 231.0], [147.0, 232.0], [144.0, 235.0], [143.0, 234.0], [141.0, 236.0], [140.0, 235.0], [141.0, 234.0], [139.0, 234.0], [137.0, 234.0], [137.0, 233.0], [136.0, 232.0], [137.0, 234.0], [134.0, 234.0], [134.0, 235.0], [129.0, 234.0], [128.0, 234.0], [132.0, 234.0], [135.0, 231.0], [136.0, 229.0], [138.0, 229.0], [138.0, 227.0], [139.0, 226.0], [139.0, 224.0], [141.0, 223.0], [140.0, 223.0], [138.0, 223.0], [138.0, 223.0], [139.0, 222.0], [143.0, 217.0], [146.0, 217.0], [147.0, 217.0], [147.0, 217.0], [149.0, 217.0], [147.0, 217.0], [149.0, 217.0], [149.0, 217.0], [150.0, 217.0], [150.0, 217.0], [150.0, 216.0], [151.0, 215.0], [150.0, 215.0], [149.0, 215.0], [149.0, 214.0], [150.0, 213.0], [150.0, 213.0], [150.0, 212.0], [148.0, 212.0], [146.0, 213.0], [139.0, 213.0], [138.0, 213.0], [138.0, 211.0], [138.0, 211.0], [137.0, 213.0], [137.0, 213.0], [137.0, 212.0], [137.0, 211.0], [137.0, 210.0], [137.0, 210.0], [138.0, 210.0], [137.0, 209.0], [137.0, 210.0], [137.0, 209.0], [137.0, 209.0], [137.0, 209.0], [137.0, 209.0], [136.0, 210.0], [135.0, 210.0], [134.0, 209.0], [133.0, 209.0], [133.0, 207.0], [133.0, 207.0], [135.0, 206.0], [135.0, 206.0], [135.0, 206.0], [135.0, 206.0], [133.0, 206.0], [133.0, 206.0], [133.0, 206.0], [133.0, 206.0], [132.0, 206.0], [132.0, 207.0], [129.0, 206.0], [128.0, 205.0], [127.0, 206.0], [127.0, 205.0], [126.0, 205.0], [127.0, 203.0], [129.0, 204.0], [128.0, 203.0], [128.0, 202.0], [127.0, 201.0], [126.0, 201.0], [128.0, 201.0], [128.0, 200.0], [132.0, 201.0], [129.0, 198.0], [134.0, 198.0], [134.0, 196.0], [134.0, 194.0], [136.0, 193.0], [138.0, 194.0], [139.0, 193.0], [138.0, 193.0], [139.0, 192.0], [138.0, 192.0], [139.0, 191.0], [139.0, 191.0], [139.0, 190.0], [136.0, 190.0], [135.0, 190.0], [134.0, 190.0], [134.0, 190.0], [134.0, 188.0], [136.0, 189.0], [136.0, 189.0], [136.0, 189.0], [136.0, 187.0], [136.0, 187.0], [136.0, 188.0], [136.0, 187.0], [136.0, 187.0], [135.0, 184.0], [135.0, 183.0], [136.0, 183.0], [135.0, 183.0], [136.0, 182.0], [135.0, 182.0], [135.0, 183.0], [134.0, 182.0], [134.0, 182.0], [134.0, 182.0], [135.0, 181.0], [134.0, 181.0], [135.0, 180.0], [134.0, 180.0], [135.0, 179.0], [135.0, 179.0], [133.0, 178.0], [133.0, 179.0], [133.0, 179.0], [133.0, 180.0], [132.0, 180.0], [132.0, 180.0], [132.0, 181.0], [132.0, 182.0], [130.0, 182.0], [132.0, 178.0], [132.0, 178.0], [130.0, 177.0], [132.0, 177.0], [132.0, 177.0], [134.0, 174.0], [134.0, 177.0], [135.0, 178.0], [135.0, 179.0], [134.0, 178.0], [134.0, 178.0], [136.0, 179.0], [136.0, 177.0], [136.0, 178.0], [136.0, 177.0], [136.0, 177.0], [136.0, 176.0], [136.0, 174.0], [138.0, 176.0], [143.0, 176.0], [144.0, 178.0], [146.0, 177.0], [147.0, 177.0], [147.0, 178.0], [148.0, 179.0], [148.0, 179.0], [148.0, 180.0], [148.0, 180.0], [149.0, 181.0], [149.0, 181.0], [151.0, 178.0], [154.0, 178.0], [156.0, 180.0], [157.0, 179.0], [157.0, 179.0], [158.0, 180.0], [160.0, 181.0], [161.0, 181.0], [160.0, 180.0], [160.0, 180.0], [161.0, 179.0], [162.0, 179.0], [161.0, 178.0], [161.0, 178.0], [162.0, 178.0], [162.0, 178.0], [161.0, 177.0], [160.0, 178.0], [159.0, 177.0], [161.0, 176.0], [161.0, 174.0], [161.0, 174.0], [163.0, 174.0], [162.0, 173.0], [163.0, 172.0], [163.0, 173.0], [167.0, 173.0], [168.0, 171.0], [168.0, 170.0], [170.0, 168.0], [170.0, 168.0], [171.0, 168.0], [170.0, 168.0], [168.0, 168.0], [167.0, 168.0], [167.0, 168.0], [167.0, 168.0], [166.0, 168.0], [163.0, 170.0], [163.0, 168.0], [166.0, 168.0], [166.0, 168.0], [163.0, 168.0], [163.0, 168.0], [161.0, 168.0], [160.0, 168.0], [157.0, 166.0], [158.0, 165.0], [157.0, 165.0], [158.0, 165.0], [158.0, 163.0], [160.0, 162.0], [165.0, 163.0], [163.0, 162.0], [162.0, 162.0], [163.0, 162.0], [166.0, 163.0], [162.0, 160.0], [163.0, 160.0], [167.0, 160.0], [166.0, 159.0], [166.0, 159.0], [167.0, 159.0], [168.0, 159.0], [167.0, 159.0], [166.0, 158.0], [166.0, 159.0], [165.0, 158.0], [165.0, 156.0], [167.0, 156.0], [166.0, 156.0], [165.0, 154.0], [166.0, 154.0], [166.0, 152.0], [167.0, 154.0], [167.0, 152.0], [168.0, 152.0], [168.0, 152.0], [168.0, 152.0], [168.0, 151.0], [169.0, 150.0], [171.0, 150.0], [171.0, 150.0], [171.0, 150.0], [171.0, 151.0], [172.0, 150.0], [174.0, 150.0], [174.0, 148.0], [174.0, 147.0], [176.0, 148.0], [176.0, 149.0], [177.0, 149.0], [177.0, 150.0], [177.0, 150.0], [178.0, 150.0], [177.0, 150.0], [178.0, 150.0], [178.0, 150.0], [178.0, 149.0], [177.0, 149.0], [177.0, 147.0], [178.0, 147.0], [178.0, 147.0], [178.0, 150.0], [179.0, 150.0], [180.0, 151.0], [180.0, 152.0], [181.0, 151.0], [180.0, 148.0], [180.0, 150.0], [180.0, 149.0], [180.0, 148.0], [179.0, 148.0], [179.0, 147.0], [180.0, 147.0], [181.0, 146.0], [182.0, 147.0], [182.0, 149.0], [183.0, 151.0], [183.0, 151.0], [183.0, 152.0], [181.0, 155.0], [182.0, 155.0], [182.0, 155.0], [181.0, 155.0], [180.0, 157.0], [182.0, 155.0], [184.0, 154.0], [184.0, 154.0], [184.0, 151.0], [183.0, 148.0], [184.0, 148.0], [183.0, 147.0], [184.0, 147.0], [184.0, 147.0], [184.0, 147.0], [187.0, 146.0], [187.0, 146.0], [187.0, 147.0], [189.0, 147.0], [187.0, 146.0], [187.0, 145.0], [187.0, 145.0], [187.0, 144.0], [185.0, 144.0], [185.0, 144.0], [189.0, 144.0], [190.0, 145.0], [191.0, 146.0], [195.0, 148.0], [195.0, 149.0], [191.0, 151.0]],
        vec![[236.0, 34.0], [237.0, 35.0], [238.0, 35.0], [239.0, 35.0], [239.0, 36.0], [240.0, 35.0], [239.0, 35.0], [239.0, 35.0], [240.0, 36.0], [242.0, 37.0], [242.0, 37.0], [240.0, 40.0], [242.0, 38.0], [242.0, 37.0], [243.0, 37.0], [243.0, 36.0], [245.0, 36.0], [246.0, 37.0], [247.0, 38.0], [246.0, 40.0], [247.0, 37.0], [249.0, 37.0], [250.0, 38.0], [250.0, 38.0], [250.0, 37.0], [251.0, 37.0], [251.0, 36.0], [253.0, 37.0], [254.0, 36.0], [254.0, 36.0], [256.0, 36.0], [257.0, 36.0], [260.0, 36.0], [262.0, 36.0], [262.0, 36.0], [262.0, 36.0], [264.0, 35.0], [266.0, 36.0], [266.0, 35.0], [265.0, 34.0], [266.0, 33.0], [266.0, 34.0], [269.0, 34.0], [269.0, 35.0], [271.0, 34.0], [271.0, 35.0], [270.0, 38.0], [270.0, 39.0], [271.0, 39.0], [270.0, 44.0], [269.0, 44.0], [268.0, 46.0], [266.0, 47.0], [264.0, 51.0], [258.0, 53.0], [257.0, 55.0], [256.0, 56.0], [254.0, 58.0], [254.0, 60.0], [253.0, 60.0], [251.0, 61.0], [250.0, 61.0], [250.0, 62.0], [253.0, 62.0], [254.0, 61.0], [255.0, 61.0], [255.0, 62.0], [256.0, 62.0], [257.0, 60.0], [258.0, 61.0], [256.0, 63.0], [254.0, 66.0], [254.0, 66.0], [254.0, 66.0], [253.0, 66.0], [250.0, 67.0], [248.0, 66.0], [248.0, 68.0], [246.0, 69.0], [246.0, 70.0], [249.0, 67.0], [253.0, 67.0], [253.0, 66.0], [254.0, 67.0], [251.0, 69.0], [251.0, 69.0], [251.0, 70.0], [250.0, 71.0], [250.0, 72.0], [249.0, 71.0], [249.0, 72.0], [249.0, 73.0], [250.0, 73.0], [250.0, 73.0], [250.0, 73.0], [253.0, 71.0], [253.0, 70.0], [253.0, 69.0], [256.0, 69.0], [260.0, 68.0], [262.0, 68.0], [264.0, 66.0], [266.0, 64.0], [271.0, 68.0], [275.0, 66.0], [276.0, 67.0], [277.0, 67.0], [283.0, 68.0], [284.0, 68.0], [286.0, 67.0], [287.0, 68.0], [289.0, 67.0], [291.0, 67.0], [291.0, 68.0], [292.0, 67.0], [293.0, 68.0], [293.0, 69.0], [293.0, 70.0], [294.0, 73.0], [294.0, 73.0], [294.0, 74.0], [295.0, 74.0], [290.0, 81.0], [289.0, 84.0], [290.0, 86.0], [287.0, 91.0], [287.0, 93.0], [286.0, 96.0], [283.0, 97.0], [283.0, 97.0], [283.0, 101.0], [283.0, 101.0], [281.0, 102.0], [282.0, 103.0], [281.0, 105.0], [278.0, 107.0], [277.0, 108.0], [276.0, 108.0], [275.0, 108.0], [273.0, 108.0], [272.0, 108.0], [271.0, 108.0], [267.0, 111.0], [266.0, 112.0], [267.0, 112.0], [268.0, 111.0], [275.0, 108.0], [276.0, 110.0], [276.0, 111.0], [276.0, 112.0], [276.0, 112.0], [277.0, 113.0], [279.0, 113.0], [280.0, 116.0], [278.0, 117.0], [276.0, 117.0], [273.0, 117.0], [272.0, 117.0], [269.0, 121.0], [269.0, 122.0], [267.0, 123.0], [265.0, 124.0], [261.0, 123.0], [258.0, 123.0], [258.0, 124.0], [259.0, 124.0], [262.0, 124.0], [265.0, 125.0], [266.0, 124.0], [267.0, 125.0], [269.0, 125.0], [270.0, 126.0], [271.0, 126.0], [272.0, 125.0], [273.0, 125.0], [275.0, 124.0], [275.0, 123.0], [276.0, 122.0], [279.0, 122.0], [280.0, 124.0], [280.0, 124.0], [282.0, 124.0], [286.0, 127.0], [289.0, 127.0], [289.0, 127.0], [290.0, 129.0], [292.0, 133.0], [294.0, 136.0], [295.0, 136.0], [295.0, 137.0], [295.0, 137.0], [295.0, 138.0], [298.0, 138.0], [298.0, 138.0], [299.0, 140.0], [300.0, 141.0], [300.0, 144.0], [299.0, 146.0], [300.0, 147.0], [300.0, 149.0], [301.0, 152.0], [301.0, 154.0], [303.0, 158.0], [304.0, 160.0], [304.0, 161.0], [306.0, 166.0], [306.0, 168.0], [309.0, 169.0], [308.0, 169.0], [309.0, 170.0], [309.0, 172.0], [309.0, 172.0], [309.0, 172.0], [309.0, 171.0], [312.0, 172.0], [315.0, 173.0], [319.0, 176.0], [321.0, 176.0], [322.0, 177.0], [322.0, 178.0], [323.0, 180.0], [325.0, 182.0], [326.0, 183.0], [327.0, 187.0], [331.0, 188.0], [328.0, 189.0], [327.0, 191.0], [330.0, 195.0], [333.0, 200.0], [335.0, 204.0], [335.0, 206.0], [335.0, 206.0], [335.0, 205.0], [335.0, 204.0], [333.0, 204.0], [333.0, 204.0], [332.0, 204.0], [330.0, 204.0], [327.0, 201.0], [326.0, 201.0], [324.0, 202.0], [322.0, 203.0], [320.0, 202.0], [319.0, 203.0], [319.0, 203.0], [321.0, 203.0], [322.0, 203.0], [323.0, 203.0], [326.0, 202.0], [327.0, 203.0], [328.0, 204.0], [332.0, 206.0], [333.0, 206.0], [333.0, 207.0], [334.0, 210.0], [336.0, 210.0], [336.0, 211.0], [337.0, 212.0], [339.0, 217.0], [341.0, 220.0], [339.0, 222.0], [336.0, 225.0], [335.0, 229.0], [334.0, 229.0], [334.0, 229.0], [335.0, 229.0], [336.0, 229.0], [336.0, 231.0], [338.0, 233.0], [341.0, 232.0], [342.0, 234.0], [342.0, 233.0], [342.0, 232.0], [343.0, 227.0], [344.0, 226.0], [346.0, 226.0], [347.0, 226.0], [350.0, 226.0], [352.0, 226.0], [352.0, 226.0], [353.0, 226.0], [354.0, 226.0], [353.0, 225.0], [354.0, 225.0], [355.0, 225.0], [356.0, 226.0], [360.0, 226.0], [363.0, 229.0], [368.0, 233.0], [368.0, 233.0], [370.0, 236.0], [370.0, 238.0], [370.0, 240.0], [370.0, 243.0], [370.0, 245.0], [368.0, 249.0], [368.0, 251.0], [368.0, 255.0], [365.0, 257.0], [364.0, 261.0], [361.0, 259.0], [361.0, 260.0], [359.0, 260.0], [358.0, 260.0], [363.0, 260.0], [360.0, 264.0], [361.0, 264.0], [361.0, 262.0], [363.0, 264.0], [363.0, 264.0], [360.0, 266.0], [358.0, 267.0], [357.0, 266.0], [356.0, 266.0], [355.0, 266.0], [354.0, 267.0], [353.0, 268.0], [350.0, 268.0], [352.0, 269.0], [352.0, 269.0], [354.0, 267.0], [355.0, 268.0], [355.0, 269.0], [355.0, 272.0], [354.0, 272.0], [353.0, 272.0], [354.0, 272.0], [354.0, 272.0], [354.0, 272.0], [355.0, 272.0], [356.0, 272.0], [353.0, 276.0], [349.0, 276.0], [348.0, 277.0], [346.0, 277.0], [345.0, 277.0], [344.0, 278.0], [345.0, 278.0], [346.0, 277.0], [347.0, 277.0], [350.0, 277.0], [352.0, 278.0], [350.0, 279.0], [349.0, 279.0], [348.0, 279.0], [347.0, 279.0], [348.0, 280.0], [349.0, 280.0], [350.0, 280.0], [350.0, 280.0], [350.0, 279.0], [352.0, 280.0], [352.0, 279.0], [352.0, 278.0], [355.0, 279.0], [356.0, 281.0], [355.0, 281.0], [353.0, 281.0], [355.0, 281.0], [361.0, 280.0], [367.0, 279.0], [366.0, 281.0], [365.0, 282.0], [366.0, 284.0], [366.0, 288.0], [365.0, 289.0], [363.0, 290.0], [361.0, 290.0], [360.0, 291.0], [358.0, 292.0], [357.0, 293.0], [357.0, 295.0], [354.0, 295.0], [352.0, 297.0], [350.0, 298.0], [344.0, 300.0], [343.0, 302.0], [342.0, 303.0], [337.0, 302.0], [333.0, 300.0], [322.0, 302.0], [322.0, 303.0], [321.0, 302.0], [321.0, 304.0], [320.0, 304.0], [317.0, 302.0], [319.0, 302.0], [317.0, 301.0], [317.0, 301.0], [316.0, 301.0], [315.0, 301.0], [316.0, 301.0], [317.0, 302.0], [314.0, 302.0], [315.0, 302.0], [315.0, 301.0], [314.0, 301.0], [314.0, 303.0], [313.0, 303.0], [313.0, 303.0], [313.0, 301.0], [313.0, 300.0], [311.0, 301.0], [312.0, 302.0], [312.0, 303.0], [309.0, 301.0], [308.0, 299.0], [305.0, 298.0], [305.0, 299.0], [306.0, 299.0], [309.0, 302.0], [308.0, 303.0], [305.0, 303.0], [304.0, 304.0], [301.0, 304.0], [299.0, 304.0], [300.0, 304.0], [300.0, 304.0], [298.0, 304.0], [297.0, 304.0], [295.0, 306.0], [295.0, 304.0], [293.0, 304.0], [292.0, 306.0], [293.0, 305.0], [293.0, 306.0], [295.0, 306.0], [295.0, 308.0], [295.0, 308.0], [295.0, 309.0], [294.0, 310.0], [293.0, 310.0], [292.0, 310.0], [290.0, 309.0], [284.0, 309.0], [284.0, 309.0], [283.0, 310.0], [284.0, 311.0], [283.0, 312.0], [283.0, 311.0], [280.0, 308.0], [277.0, 305.0], [275.0, 305.0], [272.0, 306.0], [270.0, 306.0], [268.0, 306.0], [265.0, 310.0], [264.0, 309.0], [262.0, 306.0], [262.0, 310.0], [261.0, 312.0], [261.0, 314.0], [260.0, 315.0], [260.0, 316.0], [261.0, 317.0], [261.0, 317.0], [260.0, 317.0], [259.0, 319.0], [259.0, 319.0], [258.0, 320.0], [258.0, 321.0], [258.0, 322.0], [256.0, 323.0], [255.0, 322.0], [255.0, 322.0], [254.0, 322.0], [253.0, 320.0], [251.0, 319.0], [249.0, 319.0], [247.0, 319.0], [247.0, 317.0], [246.0, 317.0], [246.0, 317.0], [247.0, 317.0], [246.0, 319.0], [245.0, 319.0], [244.0, 317.0], [243.0, 317.0], [240.0, 317.0], [239.0, 319.0], [236.0, 319.0], [235.0, 319.0], [235.0, 317.0], [234.0, 319.0], [233.0, 322.0], [231.0, 321.0], [229.0, 322.0], [228.0, 322.0], [228.0, 324.0], [227.0, 324.0], [228.0, 324.0], [227.0, 324.0], [227.0, 321.0], [227.0, 321.0], [226.0, 322.0], [227.0, 323.0], [226.0, 324.0], [227.0, 324.0], [226.0, 324.0], [226.0, 325.0], [225.0, 325.0], [226.0, 326.0], [226.0, 327.0], [226.0, 328.0], [224.0, 328.0], [224.0, 331.0], [223.0, 328.0], [222.0, 326.0], [221.0, 326.0], [217.0, 324.0], [216.0, 324.0], [216.0, 325.0], [215.0, 326.0], [213.0, 327.0], [212.0, 326.0], [213.0, 325.0], [212.0, 323.0], [213.0, 324.0], [216.0, 321.0], [218.0, 322.0], [220.0, 321.0], [221.0, 321.0], [222.0, 320.0], [223.0, 317.0], [225.0, 316.0], [225.0, 315.0], [227.0, 315.0], [228.0, 313.0], [227.0, 312.0], [228.0, 311.0], [228.0, 311.0], [229.0, 310.0], [229.0, 310.0], [231.0, 309.0], [234.0, 309.0], [234.0, 306.0], [235.0, 305.0], [236.0, 304.0], [238.0, 303.0], [238.0, 299.0], [239.0, 295.0], [240.0, 295.0], [243.0, 295.0], [244.0, 295.0], [246.0, 294.0], [247.0, 293.0], [245.0, 291.0], [246.0, 291.0], [246.0, 290.0], [246.0, 290.0], [255.0, 288.0], [259.0, 288.0], [260.0, 288.0], [262.0, 289.0], [264.0, 290.0], [266.0, 290.0], [268.0, 289.0], [270.0, 289.0], [271.0, 288.0], [271.0, 288.0], [271.0, 286.0], [272.0, 286.0], [272.0, 282.0], [275.0, 281.0], [277.0, 279.0], [278.0, 279.0], [283.0, 271.0], [284.0, 270.0], [284.0, 269.0], [284.0, 270.0], [283.0, 270.0], [278.0, 276.0], [275.0, 277.0], [272.0, 278.0], [272.0, 278.0], [272.0, 278.0], [271.0, 278.0], [269.0, 279.0], [269.0, 280.0], [268.0, 280.0], [268.0, 281.0], [267.0, 282.0], [264.0, 282.0], [260.0, 281.0], [258.0, 279.0], [257.0, 279.0], [255.0, 278.0], [254.0, 275.0], [250.0, 275.0], [250.0, 275.0], [250.0, 277.0], [247.0, 277.0], [247.0, 277.0], [246.0, 278.0], [244.0, 277.0], [244.0, 276.0], [245.0, 275.0], [246.0, 275.0], [246.0, 275.0], [248.0, 275.0], [249.0, 273.0], [249.0, 272.0], [248.0, 273.0], [247.0, 272.0], [244.0, 272.0], [244.0, 272.0], [243.0, 271.0], [243.0, 270.0], [244.0, 271.0], [243.0, 269.0], [243.0, 268.0], [243.0, 269.0], [242.0, 269.0], [242.0, 270.0], [237.0, 270.0], [236.0, 272.0], [235.0, 272.0], [234.0, 273.0], [233.0, 275.0], [231.0, 275.0], [228.0, 273.0], [228.0, 272.0], [227.0, 272.0], [227.0, 272.0], [228.0, 272.0], [228.0, 272.0], [228.0, 272.0], [229.0, 272.0], [233.0, 271.0], [229.0, 270.0], [226.0, 270.0], [226.0, 272.0], [225.0, 270.0], [224.0, 269.0], [225.0, 269.0], [226.0, 268.0], [227.0, 268.0], [227.0, 266.0], [225.0, 266.0], [223.0, 265.0], [223.0, 262.0], [225.0, 264.0], [225.0, 262.0], [227.0, 261.0], [227.0, 260.0], [229.0, 261.0], [231.0, 261.0], [232.0, 261.0], [232.0, 260.0], [233.0, 261.0], [234.0, 260.0], [234.0, 259.0], [235.0, 259.0], [236.0, 257.0], [236.0, 257.0], [236.0, 256.0], [240.0, 256.0], [243.0, 254.0], [244.0, 254.0], [246.0, 253.0], [248.0, 250.0], [249.0, 248.0], [250.0, 244.0], [251.0, 243.0], [253.0, 242.0], [250.0, 242.0], [248.0, 240.0], [250.0, 237.0], [251.0, 235.0], [250.0, 236.0], [249.0, 235.0], [248.0, 235.0], [248.0, 234.0], [249.0, 232.0], [248.0, 231.0], [243.0, 231.0], [242.0, 232.0], [242.0, 233.0], [242.0, 234.0], [240.0, 235.0], [238.0, 233.0], [238.0, 234.0], [236.0, 233.0], [236.0, 234.0], [236.0, 233.0], [236.0, 232.0], [238.0, 231.0], [240.0, 229.0], [244.0, 226.0], [244.0, 223.0], [245.0, 223.0], [245.0, 223.0], [248.0, 220.0], [249.0, 218.0], [250.0, 218.0], [254.0, 217.0], [255.0, 217.0], [254.0, 216.0], [256.0, 216.0], [257.0, 217.0], [259.0, 217.0], [265.0, 215.0], [266.0, 215.0], [266.0, 216.0], [270.0, 220.0], [270.0, 217.0], [268.0, 214.0], [268.0, 214.0], [271.0, 212.0], [271.0, 213.0], [273.0, 216.0], [276.0, 217.0], [277.0, 217.0], [278.0, 216.0], [277.0, 216.0], [275.0, 216.0], [272.0, 213.0], [270.0, 210.0], [272.0, 204.0], [276.0, 202.0], [271.0, 202.0], [270.0, 199.0], [271.0, 195.0], [275.0, 194.0], [275.0, 195.0], [276.0, 193.0], [275.0, 193.0], [275.0, 193.0], [275.0, 193.0], [273.0, 192.0], [275.0, 190.0], [276.0, 190.0], [276.0, 189.0], [276.0, 187.0], [276.0, 185.0], [275.0, 185.0], [273.0, 188.0], [272.0, 188.0], [271.0, 185.0], [270.0, 189.0], [269.0, 191.0], [269.0, 191.0], [267.0, 189.0], [267.0, 188.0], [267.0, 188.0], [268.0, 188.0], [268.0, 183.0], [267.0, 187.0], [266.0, 187.0], [264.0, 183.0], [264.0, 181.0], [259.0, 176.0], [260.0, 172.0], [261.0, 170.0], [262.0, 168.0], [264.0, 167.0], [264.0, 166.0], [265.0, 163.0], [266.0, 162.0], [266.0, 163.0], [267.0, 163.0], [267.0, 162.0], [267.0, 162.0], [267.0, 161.0], [268.0, 160.0], [270.0, 161.0], [271.0, 161.0], [271.0, 160.0], [270.0, 160.0], [270.0, 160.0], [271.0, 160.0], [271.0, 159.0], [269.0, 159.0], [267.0, 160.0], [264.0, 160.0], [264.0, 160.0], [262.0, 160.0], [261.0, 160.0], [261.0, 160.0], [261.0, 160.0], [261.0, 163.0], [260.0, 163.0], [258.0, 162.0], [257.0, 163.0], [256.0, 162.0], [256.0, 163.0], [256.0, 162.0], [256.0, 162.0], [255.0, 163.0], [256.0, 165.0], [253.0, 167.0], [251.0, 167.0], [251.0, 165.0], [250.0, 166.0], [249.0, 166.0], [248.0, 165.0], [248.0, 162.0], [247.0, 165.0], [246.0, 162.0], [245.0, 162.0], [244.0, 161.0], [244.0, 162.0], [244.0, 162.0], [244.0, 165.0], [246.0, 165.0], [245.0, 166.0], [246.0, 169.0], [245.0, 169.0], [242.0, 169.0], [240.0, 166.0], [237.0, 165.0], [236.0, 162.0], [236.0, 162.0], [234.0, 163.0], [233.0, 165.0], [234.0, 169.0], [235.0, 169.0], [235.0, 169.0], [236.0, 170.0], [235.0, 170.0], [234.0, 169.0], [234.0, 168.0], [229.0, 162.0], [228.0, 160.0], [229.0, 158.0], [231.0, 158.0], [232.0, 158.0], [232.0, 160.0], [233.0, 162.0], [233.0, 161.0], [232.0, 158.0], [232.0, 157.0], [233.0, 154.0], [236.0, 150.0], [236.0, 147.0], [237.0, 146.0], [238.0, 144.0], [240.0, 144.0], [240.0, 141.0], [239.0, 140.0], [239.0, 140.0], [239.0, 139.0], [239.0, 138.0], [237.0, 137.0], [237.0, 136.0], [235.0, 134.0], [236.0, 133.0], [236.0, 130.0], [235.0, 127.0], [236.0, 126.0], [237.0, 125.0], [238.0, 127.0], [243.0, 127.0], [240.0, 125.0], [238.0, 124.0], [237.0, 122.0], [237.0, 124.0], [238.0, 124.0], [237.0, 124.0], [236.0, 124.0], [236.0, 122.0], [237.0, 121.0], [236.0, 121.0], [236.0, 119.0], [236.0, 119.0], [235.0, 121.0], [236.0, 122.0], [236.0, 124.0], [235.0, 124.0], [235.0, 124.0], [234.0, 128.0], [233.0, 128.0], [233.0, 126.0], [232.0, 124.0], [232.0, 127.0], [229.0, 126.0], [229.0, 124.0], [229.0, 124.0], [229.0, 127.0], [228.0, 127.0], [229.0, 129.0], [227.0, 128.0], [226.0, 127.0], [227.0, 124.0], [228.0, 122.0], [229.0, 121.0], [229.0, 119.0], [233.0, 118.0], [233.0, 117.0], [235.0, 115.0], [234.0, 116.0], [233.0, 116.0], [232.0, 118.0], [228.0, 119.0], [226.0, 124.0], [225.0, 124.0], [225.0, 124.0], [225.0, 125.0], [225.0, 126.0], [225.0, 128.0], [227.0, 130.0], [227.0, 132.0], [226.0, 133.0], [225.0, 134.0], [224.0, 136.0], [224.0, 137.0], [224.0, 138.0], [224.0, 138.0], [224.0, 139.0], [222.0, 144.0], [222.0, 144.0], [222.0, 144.0], [223.0, 145.0], [222.0, 147.0], [220.0, 148.0], [217.0, 147.0], [217.0, 144.0], [220.0, 144.0], [220.0, 139.0], [220.0, 138.0], [221.0, 136.0], [221.0, 135.0], [224.0, 129.0], [222.0, 132.0], [221.0, 130.0], [221.0, 129.0], [223.0, 126.0], [221.0, 127.0], [221.0, 126.0], [223.0, 122.0], [222.0, 123.0], [221.0, 126.0], [220.0, 126.0], [221.0, 124.0], [222.0, 123.0], [222.0, 122.0], [223.0, 121.0], [224.0, 121.0], [223.0, 119.0], [224.0, 117.0], [223.0, 119.0], [222.0, 119.0], [223.0, 117.0], [223.0, 115.0], [223.0, 112.0], [224.0, 112.0], [225.0, 108.0], [229.0, 108.0], [227.0, 107.0], [226.0, 107.0], [226.0, 107.0], [226.0, 107.0], [225.0, 107.0], [226.0, 106.0], [227.0, 106.0], [228.0, 105.0], [229.0, 105.0], [227.0, 105.0], [226.0, 105.0], [227.0, 102.0], [228.0, 102.0], [228.0, 102.0], [229.0, 101.0], [232.0, 101.0], [233.0, 101.0], [232.0, 101.0], [229.0, 101.0], [233.0, 95.0], [231.0, 97.0], [229.0, 97.0], [228.0, 100.0], [227.0, 101.0], [227.0, 101.0], [225.0, 103.0], [224.0, 105.0], [221.0, 106.0], [221.0, 106.0], [220.0, 105.0], [220.0, 105.0], [217.0, 104.0], [215.0, 103.0], [215.0, 102.0], [216.0, 101.0], [217.0, 101.0], [221.0, 100.0], [222.0, 101.0], [224.0, 101.0], [222.0, 101.0], [220.0, 100.0], [218.0, 101.0], [217.0, 100.0], [212.0, 100.0], [211.0, 99.0], [213.0, 97.0], [215.0, 97.0], [216.0, 96.0], [217.0, 97.0], [218.0, 97.0], [218.0, 96.0], [218.0, 97.0], [220.0, 96.0], [220.0, 96.0], [218.0, 95.0], [218.0, 94.0], [221.0, 94.0], [221.0, 94.0], [222.0, 94.0], [222.0, 94.0], [221.0, 94.0], [221.0, 94.0], [221.0, 93.0], [217.0, 92.0], [218.0, 93.0], [220.0, 93.0], [218.0, 92.0], [220.0, 90.0], [221.0, 89.0], [221.0, 90.0], [222.0, 91.0], [225.0, 90.0], [223.0, 90.0], [222.0, 90.0], [222.0, 89.0], [222.0, 88.0], [221.0, 88.0], [221.0, 86.0], [222.0, 85.0], [223.0, 85.0], [225.0, 88.0], [226.0, 86.0], [224.0, 86.0], [224.0, 85.0], [223.0, 83.0], [222.0, 83.0], [223.0, 83.0], [223.0, 82.0], [223.0, 81.0], [223.0, 80.0], [225.0, 80.0], [225.0, 80.0], [227.0, 82.0], [227.0, 81.0], [226.0, 81.0], [225.0, 80.0], [222.0, 80.0], [222.0, 80.0], [223.0, 78.0], [225.0, 77.0], [226.0, 74.0], [225.0, 77.0], [224.0, 78.0], [223.0, 77.0], [224.0, 77.0], [224.0, 75.0], [221.0, 78.0], [220.0, 78.0], [220.0, 75.0], [221.0, 75.0], [220.0, 75.0], [221.0, 74.0], [220.0, 74.0], [220.0, 72.0], [221.0, 70.0], [221.0, 70.0], [222.0, 71.0], [222.0, 70.0], [223.0, 72.0], [223.0, 72.0], [224.0, 72.0], [225.0, 71.0], [224.0, 71.0], [223.0, 70.0], [223.0, 70.0], [223.0, 70.0], [222.0, 69.0], [222.0, 68.0], [221.0, 68.0], [221.0, 64.0], [223.0, 64.0], [223.0, 64.0], [222.0, 64.0], [221.0, 63.0], [221.0, 62.0], [221.0, 60.0], [223.0, 60.0], [223.0, 60.0], [223.0, 62.0], [224.0, 63.0], [224.0, 62.0], [225.0, 62.0], [225.0, 60.0], [224.0, 60.0], [224.0, 58.0], [225.0, 58.0], [225.0, 58.0], [225.0, 60.0], [227.0, 60.0], [227.0, 58.0], [232.0, 60.0], [232.0, 60.0], [228.0, 58.0], [228.0, 57.0], [228.0, 57.0], [229.0, 59.0], [232.0, 58.0], [233.0, 60.0], [234.0, 61.0], [234.0, 60.0], [232.0, 58.0], [233.0, 58.0], [233.0, 58.0], [231.0, 56.0], [229.0, 55.0], [228.0, 53.0], [228.0, 53.0], [227.0, 52.0], [227.0, 51.0], [229.0, 52.0], [229.0, 52.0], [232.0, 52.0], [232.0, 52.0], [231.0, 51.0], [232.0, 51.0], [231.0, 50.0], [232.0, 50.0], [231.0, 50.0], [231.0, 50.0], [229.0, 49.0], [229.0, 49.0], [228.0, 47.0], [228.0, 46.0], [231.0, 48.0], [233.0, 47.0], [233.0, 48.0], [234.0, 47.0], [237.0, 48.0], [236.0, 47.0], [237.0, 47.0], [235.0, 47.0], [234.0, 46.0], [234.0, 45.0], [234.0, 45.0], [233.0, 45.0], [234.0, 41.0], [236.0, 42.0], [235.0, 41.0], [235.0, 41.0], [235.0, 41.0], [235.0, 40.0], [236.0, 40.0], [237.0, 40.0], [236.0, 39.0], [234.0, 38.0], [234.0, 38.0], [236.0, 37.0]],
    ];
    let gb_poly: Vec<Vec<Vec<f64>>> = convert_f64vec(gb_poly);

    let arrow_poly = vec![
        vec![[246.0, 146.0], [313.0, 146.0], [290.0, 168.0], [335.0, 191.0], [290.0, 235.0], [268.0, 191.0], [246.0, 213.0]],
        vec![[246.0, 57.0], [268.0, 79.0], [290.0, 35.0], [335.0, 79.0], [290.0, 102.0], [313.0, 124.0], [246.0, 124.0]],
        vec![[224.0, 146.0], [224.0, 213.0], [201.0, 191.0], [179.0, 235.0], [134.0, 191.0], [179.0, 168.0], [157.0, 146.0]],
        vec![[179.0, 102.0], [134.0, 79.0], [179.0, 35.0], [201.0, 79.0], [224.0, 57.0], [224.0, 124.0], [157.0, 124.0]],
    ];
    let arrow_poly: Vec<Vec<Vec<f64>>> = convert_f64vec(arrow_poly);

    cases.push(Case {
        name: "GB and Arrows".to_string(),
        red: clipper_to_graph(&gb_poly),
        blue: clipper_to_graph(&arrow_poly),
    });

    let phantom_poly = vec![
        vec![[-29.42, 106.23], [-26.7, 105.45], [-11.55, 101.73], [0.12, 99.72], [9.69, 98.94], [17.63, 99.17], [24.29, 100.23], [23.93, 92.91], [24.08, 81.36], [25.12, 70.62], [26.99, 60.59], [29.66, 51.22], [33.11, 42.43], [37.31, 34.29], [42.16, 26.9], [47.77, 20.05], [53.98, 13.98], [60.82, 8.61], [68.2, 4.01], [76.04, 0.24], [84.37, -2.73], [92.97, -4.8], [101.89, -5.98], [110.88, -6.23], [120.0, -5.53], [128.99, -3.88], [137.63, -1.36], [145.94, 2.06], [153.87, 6.32], [161.29, 11.4], [168.03, 17.14], [174.22, 23.66], [179.7, 30.8], [184.49, 38.59], [188.54, 46.95], [191.9, 56.1], [194.44, 65.81], [196.16, 76.18], [197.0, 87.09], [196.94, 98.79], [195.88, 111.18], [207.51, 112.86], [220.6, 115.46], [233.18, 118.91], [245.2, 123.18], [256.72, 128.26], [267.97, 134.26], [278.87, 141.16], [289.73, 149.16], [300.72, 158.47], [312.07, 169.38], [312.06, 169.37], [336.14, 177.32], [355.16, 183.81], [367.78, 189.0], [378.1, 194.19], [387.04, 199.69], [395.07, 205.73], [400.6, 210.78], [405.18, 216.34], [409.93, 223.8], [420.35, 243.91], [425.91, 253.51], [431.07, 260.69], [436.35, 266.43], [436.34, 266.42], [443.69, 272.81], [469.07, 291.49], [477.42, 298.56], [483.68, 305.01], [487.79, 310.56], [497.28, 326.73], [502.53, 334.76], [511.53, 345.81], [337.97, 345.86], [315.38, 321.1], [303.25, 308.84], [303.26, 308.85], [292.72, 299.47], [292.69, 299.5], [290.88, 300.26], [290.89, 300.25], [283.26, 304.12], [283.27, 304.11], [275.98, 308.87], [268.76, 314.74], [261.42, 322.02], [261.43, 322.01], [253.55, 331.26], [242.73, 345.84], [-29.42, 345.86]],
        vec![[127.69, 269.76], [127.68, 269.77], [133.88, 268.63], [133.87, 268.64], [139.54, 266.65], [139.53, 266.66], [144.66, 263.86], [144.65, 263.87], [149.4, 260.18], [149.39, 260.19], [153.81, 255.5], [158.06, 249.51], [162.29, 241.74], [166.81, 231.1], [166.8, 231.11], [176.87, 202.06], [182.04, 188.77], [182.04, 188.78], [182.02, 188.77], [181.74, 188.64], [181.75, 188.65], [179.85, 188.27], [178.29, 188.8], [178.3, 188.79], [176.74, 190.4], [176.75, 190.39], [173.98, 196.05], [173.14, 196.87], [172.34, 196.57], [171.01, 194.4], [174.86, 188.74], [180.8, 179.01], [185.49, 169.61], [185.48, 169.62], [188.88, 160.79], [188.87, 160.8], [191.15, 152.4], [191.14, 152.41], [192.39, 144.4], [192.38, 144.41], [192.65, 136.76], [192.65, 136.77], [191.95, 129.43], [191.96, 129.44], [190.36, 122.45], [189.2, 126.33], [186.64, 132.72], [183.5, 138.19], [179.85, 142.75], [175.82, 146.34], [171.49, 149.01], [166.88, 150.79], [162.01, 151.66], [157.07, 151.61], [152.08, 150.61], [147.07, 148.62], [142.21, 145.63], [137.56, 141.62], [133.27, 136.62], [129.46, 130.68], [129.03, 130.72], [129.04, 130.71], [124.06, 131.87], [124.07, 131.86], [119.96, 133.69], [116.46, 136.26], [116.47, 136.25], [113.27, 139.82], [107.23, 149.32], [104.14, 153.18], [101.0, 155.72], [97.49, 157.4], [93.11, 158.38], [88.02, 158.61], [83.43, 157.91], [79.22, 156.35], [75.0, 153.77], [70.26, 149.63], [60.57, 138.77], [54.38, 132.43], [54.39, 132.44], [49.11, 128.26], [43.79, 125.19], [43.54, 126.2], [43.55, 126.19], [43.13, 133.69], [43.13, 133.68], [43.66, 140.71], [43.65, 140.7], [45.09, 147.46], [45.08, 147.45], [47.49, 154.24], [47.48, 154.23], [51.23, 161.76], [63.98, 182.09], [67.55, 189.18], [69.73, 195.4], [70.92, 201.58], [71.16, 207.87], [70.43, 214.58], [68.63, 221.85], [68.56, 221.68], [68.68, 203.83], [68.68, 203.84], [68.16, 197.1], [68.17, 197.11], [67.05, 192.75], [67.06, 192.76], [65.5, 189.85], [65.51, 189.86], [63.49, 187.86], [60.94, 186.59], [60.95, 186.6], [57.55, 186.01], [57.78, 189.41], [57.77, 189.4], [59.32, 201.46], [59.31, 201.45], [61.68, 212.76], [61.67, 212.75], [64.76, 223.11], [64.75, 223.1], [68.47, 232.45], [72.73, 240.71], [77.44, 247.84], [82.45, 253.81], [82.44, 253.8], [87.82, 258.8], [93.45, 262.8], [93.44, 262.79], [99.44, 265.89], [99.43, 265.88], [105.67, 268.07], [105.66, 268.06], [112.58, 269.42], [112.57, 269.41], [120.65, 270.08]],
        vec![[121.49, 240.71], [118.05, 239.68], [115.54, 238.06], [113.86, 235.97], [112.96, 233.43], [112.86, 230.29], [112.9, 230.33], [114.24, 231.32], [114.23, 231.31], [117.3, 232.52], [117.29, 232.51], [122.05, 233.17], [132.1, 233.03], [140.49, 233.06], [139.8, 234.49], [137.79, 236.7], [134.63, 238.72], [130.41, 240.25], [125.83, 240.94]],
        vec![[90.76, 219.11], [91.11, 218.28], [92.59, 216.41], [95.22, 214.69], [99.6, 213.14], [106.53, 211.9], [117.0, 211.2], [143.09, 211.3], [151.49, 210.93], [151.31, 211.49], [149.72, 213.46], [147.43, 214.88], [143.97, 215.82], [138.58, 216.09], [117.5, 214.37], [117.51, 214.38], [108.81, 214.35], [101.81, 215.22], [101.82, 215.21], [95.89, 216.85], [95.9, 216.84], [90.72, 219.22]],
        vec![[131.9, 198.38], [131.72, 195.25], [132.38, 192.96], [133.78, 191.21], [136.84, 189.34], [140.91, 187.09], [142.52, 185.35], [143.3, 183.24], [143.3, 183.25], [143.22, 183.13], [141.54, 180.12], [139.65, 174.9], [138.32, 168.14], [137.62, 158.87], [137.76, 144.77], [142.77, 159.79], [145.49, 170.4], [146.69, 178.4], [146.78, 184.55], [146.02, 189.28], [144.58, 192.89], [142.54, 195.66], [139.94, 197.69], [136.5, 199.14], [132.22, 199.86]],
        vec![[108.17, 188.43], [106.35, 187.41], [105.13, 185.72], [104.56, 183.25], [104.61, 183.31], [104.81, 183.53], [104.8, 183.52], [106.39, 184.64], [106.38, 184.63], [108.44, 184.92], [114.0, 183.64], [116.83, 183.49], [119.09, 184.26], [121.14, 185.99], [120.5, 186.31], [114.98, 188.22], [110.98, 188.8]],
        vec![[163.89, 141.31], [166.4, 137.22], [174.87, 127.72], [177.63, 123.62], [179.28, 119.59], [179.28, 119.6], [179.24, 119.6], [179.25, 119.59], [176.7, 119.79], [176.71, 119.78], [170.65, 120.87], [170.66, 120.86], [164.55, 122.95], [164.56, 122.94], [148.93, 130.62], [148.93, 130.61], [149.21, 132.61], [149.2, 132.6], [150.57, 136.41], [152.55, 139.41], [152.54, 139.4], [155.11, 141.71], [155.1, 141.7], [158.43, 143.41], [158.42, 143.4], [162.62, 144.5]],
        vec![[90.87, 144.21], [90.86, 144.22], [93.93, 139.6], [97.47, 134.4], [99.02, 130.65], [99.02, 130.66], [98.92, 130.62], [98.93, 130.63], [63.23, 119.65], [67.31, 125.14], [73.8, 132.62], [73.79, 132.61], [79.3, 137.68], [84.84, 141.56], [84.83, 141.55], [90.59, 144.44]],
        vec![[128.47, 127.41], [128.46, 127.42], [134.55, 125.73], [134.54, 125.74], [141.57, 122.7], [141.56, 122.71], [154.9, 115.21], [164.19, 110.32], [171.16, 107.57], [177.57, 106.0], [183.83, 105.4], [190.12, 105.74], [182.19, 101.42], [182.2, 101.43], [175.96, 98.85], [175.97, 98.86], [170.13, 97.45], [170.14, 97.46], [164.0, 96.98], [157.13, 97.46], [157.08, 97.55], [156.47, 98.59], [153.09, 103.35], [149.58, 106.83], [145.83, 109.3], [141.79, 110.89], [137.21, 111.67], [131.97, 111.55], [125.78, 110.38], [117.8, 107.78], [92.32, 96.78], [92.33, 96.79], [83.94, 93.95], [83.95, 93.96], [77.47, 92.65], [77.48, 92.66], [72.09, 92.45], [67.49, 93.16], [67.5, 93.15], [63.28, 94.72], [63.29, 94.71], [59.49, 97.13], [55.9, 100.53], [55.91, 100.52], [52.52, 105.09], [49.25, 111.18], [52.77, 110.06], [58.91, 108.7], [64.9, 108.31], [70.86, 108.86], [77.27, 110.42], [84.53, 113.27], [105.04, 123.87], [105.03, 123.86], [111.74, 126.51], [111.73, 126.5], [117.29, 127.77], [117.28, 127.76], [122.82, 128.06]],
    ];
    let phantom_poly: Vec<Vec<Vec<f64>>> = convert_f64vec(phantom_poly);

    let skull_poly = vec![
        vec![[385.77, 166.95], [386.68, 182.21], [386.15, 187.13], [384.96, 190.99], [382.95, 194.32], [379.91, 197.42], [375.8, 200.17], [370.59, 202.47], [364.37, 204.13], [357.67, 204.95], [350.93, 204.85], [344.71, 203.87], [339.59, 202.19], [335.52, 199.95], [332.61, 197.37], [330.67, 194.53], [329.62, 191.41], [329.4, 187.83], [330.02, 183.99], [331.34, 181.14], [333.27, 179.05], [336.11, 177.4], [340.71, 176.05], [352.22, 173.98], [356.3, 172.51], [361.25, 169.4], [370.03, 163.12], [373.94, 161.22], [377.01, 160.6], [379.53, 160.94], [381.9, 162.19], [384.3, 164.67], [385.77, 166.93], [385.77, 166.95]],
        vec![[270.77, 163.84], [273.88, 163.4], [276.36, 163.91], [280.12, 166.08], [285.42, 169.2], [291.02, 171.33], [299.79, 173.33], [307.68, 175.13], [311.52, 176.78], [314.01, 178.71], [315.73, 181.15], [316.83, 184.41], [317.2, 188.89], [316.7, 192.44], [315.33, 195.6], [313.05, 198.56], [309.77, 201.19], [305.39, 203.45], [299.95, 205.12], [293.7, 205.99], [287.12, 205.96], [280.75, 205.0], [275.02, 203.24], [270.05, 200.77], [266.08, 197.81], [263.1, 194.47], [260.95, 190.7], [259.68, 186.54], [259.29, 181.92], [259.86, 176.86], [261.36, 171.68], [263.13, 168.56], [265.48, 166.25], [268.64, 164.55], [270.77, 163.84], [270.77, 163.84]],
        vec![[303.94, 227.57], [303.74, 222.63], [304.44, 218.35], [305.94, 214.59], [308.24, 211.27], [311.35, 208.46], [315.13, 206.32], [319.55, 204.91], [324.31, 204.37], [329.09, 204.77], [333.4, 206.03], [337.08, 208.03], [339.99, 210.61], [342.11, 213.69], [343.43, 217.19], [343.94, 221.2], [343.59, 225.38], [342.53, 228.01], [340.69, 230.17], [337.79, 232.02], [333.81, 233.34], [328.46, 234.03], [322.02, 233.83], [315.23, 232.68], [309.37, 230.81], [305.39, 228.73], [303.99, 227.61], [303.94, 227.57]],
        vec![[421.16, 64.34], [421.16, 64.45], [422.7, 96.81], [424.28, 149.29], [425.26, 216.18], [425.57, 327.02], [220.65, 327.02], [220.41, 312.05], [219.69, 230.46], [219.9, 144.66], [221.01, 65.92], [233.74, 65.34], [264.63, 64.78], [325.38, 65.31], [363.93, 65.31], [393.46, 64.48], [420.05, 62.8], [420.8, 62.92], [421.16, 64.34]],
        vec![[404.57, 215.13], [404.58, 215.08], [405.83, 205.87], [406.55, 194.49], [406.3, 183.7], [405.16, 173.57], [403.17, 164.03], [400.34, 155.01], [396.73, 146.61], [392.34, 138.76], [387.23, 131.54], [381.47, 125.02], [375.05, 119.16], [368.04, 114.01], [360.39, 109.58], [352.3, 105.99], [343.88, 103.28], [335.22, 101.47], [326.42, 100.59], [317.57, 100.64], [308.77, 101.63], [300.3, 103.53], [292.06, 106.33], [284.32, 109.94], [277.01, 114.36], [270.11, 119.65], [263.83, 125.67], [258.83, 131.66], [253.44, 139.77], [248.35, 149.13], [244.11, 158.88], [241.0, 168.28], [239.0, 177.21], [238.09, 185.4], [238.17, 192.9], [239.13, 199.57], [240.91, 205.61], [243.45, 211.04], [246.09, 214.67], [249.63, 217.9], [254.56, 221.04], [270.07, 228.23], [275.76, 231.57], [279.77, 234.93], [282.82, 238.64], [285.08, 242.87], [286.61, 247.72], [287.31, 253.67], [287.19, 274.82], [287.8, 281.39], [288.94, 285.57], [290.57, 288.43], [292.56, 290.24], [295.1, 291.3], [295.83, 283.75], [296.0, 265.6], [296.31, 250.76], [297.29, 241.67], [299.29, 240.75], [303.08, 239.94], [307.26, 240.0], [307.66, 242.7], [309.02, 256.43], [310.57, 291.19], [311.49, 291.54], [314.95, 293.31], [316.6, 294.82], [316.6, 295.52], [315.35, 295.94], [315.99, 296.02], [317.2, 295.47], [318.2, 293.99], [319.04, 290.81], [319.39, 284.37], [318.41, 262.35], [318.37, 251.85], [319.08, 245.75], [320.27, 242.05], [321.29, 240.77], [323.08, 240.08], [328.27, 240.0], [329.31, 244.13], [330.19, 252.03], [330.63, 273.92], [331.25, 284.25], [332.33, 289.99], [333.7, 293.31], [335.26, 295.12], [337.01, 295.94], [337.81, 294.94], [339.33, 291.52], [340.32, 286.68], [340.61, 279.64], [339.38, 260.18], [339.31, 251.49], [340.05, 245.84], [341.39, 241.87], [342.36, 240.75], [344.31, 240.04], [351.49, 240.0], [351.67, 240.9], [352.45, 248.35], [352.58, 274.14], [353.27, 282.2], [354.5, 287.31], [356.13, 290.68], [358.13, 292.86], [359.27, 289.89], [360.62, 284.2], [361.32, 276.58], [361.16, 258.89], [361.45, 247.8], [365.47, 242.21], [370.89, 236.4], [377.72, 230.54], [385.94, 224.78], [395.31, 219.41], [404.57, 215.13]],
    ];
    let  skull_poly: Vec<Vec<Vec<f64>>> = convert_f64vec(skull_poly);

    cases.push(Case {
        name: "Phantom and Skull".to_string(),
        red: clipper_to_graph(&phantom_poly),
        blue: clipper_to_graph(&skull_poly),
    });
    cases
}


const NUM_ITER:usize = 100;
const WARM_UP :usize = 10;



fn benchmark(red:&Vec<Vec<Vec<f64>>>, blue:&Vec<Vec<Vec<f64>>>,
             algo: &Fn( &[Vec<Vec<f64>>],  &[Vec<Vec<f64>>]) -> Vec<Vec<usize>>) ->Vec<f64>{
	for _ in  0.. WARM_UP{
		algo(red, blue);
	}

	let start = PreciseTime::now();
	let mut count = 0;

	for _  in  0.. NUM_ITER {
		let result = algo(red, blue);
		count += result.len()
	}
	let  end = PreciseTime::now();
//    time::Duration::seconds()
	return vec![ (start.to(end).num_milliseconds()) as f64 / (NUM_ITER as f64), (count as f64)]
}


fn main() {
    let cases = init();

    println!("testing {} {}",  "Brute-force" , "...");
    for j  in 0..cases.len() {
        println!("case: {}", cases[j].name);
        let res = benchmark(&cases[j].red, &cases[j].blue, &brute_force);
        println!("\ttime: {} ms - total isect: {}", res[0], res[1])
    }
    //------------------------------------------------------------------------------------
    println!("testing {} {}",  "RBLSI" , "...");
    for j  in 0..cases.len() {
        println!("case: {}", cases[j].name);
        let res = benchmark(&cases[j].red, &cases[j].blue, &rb_intersection);
        println!("\ttime: {} ms - total isect: {}", res[0], res[1])
    }
}